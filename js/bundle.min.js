Stun.utils=Stun.$u={debounce:function(t,e,n){var i;return function(){var o=this,a=arguments;if(i&&clearTimeout(i),n){var r=!i;i=setTimeout(function(){i=null},e),r&&t.apply(o,a)}else i=setTimeout(function(){t.apply(o,a)},e)}},throttle:function(t,e,n){var i,o,a,r=0;n||(n={});var l=function(){r=!1===n.leading?0:(new Date).getTime(),i=null,t.apply(o,a),i||(o=a=null)};return function(){var c=(new Date).getTime();r||!1!==n.leading||(r=c);var s=e-(c-r);o=this,a=arguments,s<=0||s>e?(i&&(clearTimeout(i),i=null),r=c,t.apply(o,a),i||(o=a=null)):i||!1===n.trailing||(i=setTimeout(l,s))}},codeToKeyCode:function(t){return{ArrowLeft:37,ArrowRight:39,Escape:27,Enter:13}[t]},popAlert:function(t,e,n){if(!$(".stun-alert")[0]){var i=$('<div class="stun-message"><div class="stun-alert stun-alert-'+t+'"><i class="stun-alert-icon fa fa-'+{success:"check-circle",info:"exclamation-circle",warning:"exclamation-circle",error:"times-circle"}[t]+'"></i><span class="stun-alert-description">'+e+"</span></div></div>");$("body").append(i)}$(document).ready(function(){$(".stun-alert").velocity("stop").velocity("transition.slideDownBigIn",{duration:300}).velocity("reverse",{delay:1e3*n||5e3,duration:260,complete:function(){$(".stun-alert").css("display","none")}})})},copyText:function(t){try{var e=window.getSelection(),n=document.createRange();n.selectNodeContents(t),e.removeAllRanges(),e.addRange(n);var i=e.toString(),o=document.createElement("input");if(o.style.display="none",o.setAttribute("readonly","readonly"),o.setAttribute("value",i),document.body.appendChild(o),o.setSelectionRange(0,-1),document.execCommand("copy"))return document.execCommand("copy"),document.body.removeChild(o),!0;document.body.removeChild(o)}catch(t){return!1}},wrapImageWithFancyBox:function(){$(".content img").not(":hidden").each(function(){var t=$(this),e=t.attr("title")||t.attr("alt"),n=t.parent("a");if(!n[0]){var i=t.attr("data-original")||t.attr("src");n=t.wrap('<a class="fancybox" href="'+i+'" itemscope itemtype="http://schema.org/ImageObject" itemprop="url"></a>').parent("a"),t.is(".gallery img")?n.attr("data-fancybox","gallery"):n.attr("data-fancybox","default")}e&&n.attr("title",e).attr("data-caption",e)}),$().fancybox({selector:"[data-fancybox]",loop:!0,transitionEffect:"slide",buttons:["share","slideShow","fullScreen","download","thumbs","close"]})},galleryWaterFall:function(){var t=CONFIG.gallery_waterfall,e=parseInt(t.col_width),n=parseInt(t.gap_x);this.waitAllImageLoad(".gallery img",function(){$(".gallery").masonry({itemSelector:".gallery-image",columnWidth:e,percentPosition:!0,gutter:n,transitionDuration:0})})},lazyLoadImages:function(){$("img.lazyload").lazyload()},addIconToExternalLink:function(t){if($(t)[0]){var e=$('<span class="external-link"></span>'),n=$('<i class="fa fa-'+CONFIG.external_link.icon.name+'"></i>');$(t).find('a[target="_blank"]').wrap(e).parent(".external-link").append(n)}},back2top:function(){function t(){var t=$("#back-top");0!==$(window).scrollTop()?t.css("visibility","visible"):t.css("visibility","hidden")}$(window).on("load",t),$(window).on("scroll",t),$("#back-top").on("click",function(){$("body").velocity("stop").velocity("scroll"),CONFIG.back2top.animation&&$("#back-top").velocity({translateY:"-100vh"},{duration:500}).velocity("reverse",{duration:10})})},registerSwitchPost:function(){var t=this;$(document).on("keydown",function(e){var n=e.keyCode===t.codeToKeyCode("ArrowLeft"),i=e.keyCode===t.codeToKeyCode("ArrowRight");if(e.ctrlKey&&n){var o=$(".article-prev").find("a")[0];o&&o.click()}else if(e.ctrlKey&&i){var a=$(".article-next").find("a")[0];a&&a.click()}})},registerShowReward:function(){$(".reward-button").on("click",function(){var t=$(".reward-qr-wrapper");t.is(":visible")?t.css("display","none"):t.velocity("stop").velocity("transition.slideDownBigIn",{duration:300})})},registerClickToZoomImage:function(){$(".content img").not(":hidden").each(function(){$(this).addClass("zoom-image")});var t=$('<div class="zoom-image-mask"></div>'),e=$("<img>"),n=!1;function i(){e.velocity("reverse"),t.velocity("reverse",{complete:function(){$(".zoom-image.show").remove(),$(".zoom-image-mask").remove(),$(".zoom-image").removeClass("hide")}})}$(window).on("scroll",function(){n&&(n=!1,setTimeout(i,200))}),$(document).on("click",function(){i()}),$(".zoom-image").on("click",function(i){i.stopPropagation(),n=!0;var o=this.getBoundingClientRect(),a=$(this).width(),r=$(this).height(),l=$(this).outerWidth(),c=$(this).outerHeight(),s=$(window).width(),d=$(window).height(),u=s/a,m=d/r,p=(u<m?u:m)||1,f=s/2-(o.x+l/2),y=d/2-(o.y+c/2);e.attr("class",this.className),e.attr("src",this.src),e.addClass("show"),e.css({left:$(this).offset().left+(l-a)/2,top:$(this).offset().top+(c-r)/2,width:a,height:r}),$(this).addClass("hide"),$("body").append(t).append(e),t.velocity({opacity:1}),e.velocity({translateX:f,translateY:y,scale:p},{duration:300,easing:[.2,0,.2,1]})})},waitAllImageLoad:function(t,e){var n=[];$(t).each(function(){var t=$.Deferred();$(this).bind("load",function(){t.resolve()}),this.complete&&setTimeout(function(){t.resolve()},500),n.push(t)}),$.when.apply(null,n).then(e)}};$(document).ready(function(){if(CONFIG.shortcuts.switch_post&&Stun.utils.registerSwitchPost(),CONFIG.reward&&Stun.utils.registerShowReward(),CONFIG.back2top&&Stun.utils.back2top(),CONFIG.gallery_waterfall&&Stun.utils.galleryWaterFall(),CONFIG.lazyload&&Stun.utils.lazyLoadImages(),CONFIG.external_link){Stun.utils.addIconToExternalLink(".archive-inner, .post-title, #footer")}CONFIG.fancybox?Stun.utils.wrapImageWithFancyBox():CONFIG.zoom_image&&Stun.utils.registerClickToZoomImage()});$(document).ready(function(){$("figure.highlight").each(function(){if(!$(this).find("figcaption")[0]){var i=this.getAttribute("class").split(/\s/).filter(function(i){return"highlight"!==i}),t=$('<figcaption class="custom"><span>'+i+"</span></figcaption>")[0];this.insertBefore(t,$(this).children().first()[0])}});var i=$('<div class="copy-button"><i class="fa fa-clipboard"></i></div>');$("figure.highlight figcaption, .post-copyright").append(i),$(".copy-button").on("click",function(){var i=null,t=$(this).parent("figcaption").parent("figure").find("td.code")[0];i=t||$(this).parent()[0],Stun.utils.copyText(i)?Stun.utils.popAlert("success",CONFIG.notification.copy_success):Stun.utils.popAlert("error",CONFIG.notification.copy_error)})});$(document).ready(function(){var e=0;function a(){var a=$(window).scrollTop(),n=a-e;0===a?($(".header-nav").removeClass("fixed"),$(".header-nav").removeClass("slider-up"),$(".header-nav").addClass("slider-down")):($(".header-nav").addClass("fixed"),n>0?Math.abs(n)>5&&($(".header-nav").removeClass("slider-down"),$(".header-nav").addClass("slider-up")):Math.abs(n)>5&&($(".header-nav").removeClass("slider-up"),$(".header-nav").addClass("slider-down"))),e=a}function n(e){$(e).velocity("stop").velocity("scroll",{easing:"easeOutSine"})}a(),$(window).scroll(function(){a()}),$(".content").find("h1,h2,h3,h4,h5,h6").on("click",function(){n("#"+$(this).attr("id"))}),$(".toc-link").on("click",function(e){e.preventDefault(),n($(this).attr("href"))})});$(document).ready(function(){var n=$(".header-nav-menu");$(document).on("click",function(){n.removeClass("show")}),$(".header-nav-menu a").on("click",function(n){n.stopPropagation()}),$(".header-nav-menu-icon").on("click",function(){return n.toggleClass("show"),!1})});$(document).ready(function(){var e=$(".sidebar-toc"),t=$(".sidebar-overview"),i=null,o=null,n=!1,s=parseInt(CONFIG.sidebar.offsetTop),a=!1,r=!0;function c(){var e=$(".post-body"),t=e.find("h1,h2,h3,h4,h5,h6"),n=t.first();if(e[0]&&n[0]&&n.offset().top-$(window).scrollTop()>0)$(".sidebar-toc li").removeClass("active current");else if(t.each(function(){this.getBoundingClientRect().top<0&&(i=$(this).attr("id"))}),i!==o){var s=$('.sidebar-toc a[href="#'+i+'"]');s[0]&&$(".sidebar-toc li").removeClass("active current"),s.parents("li").addClass("active"),s.parent().addClass("current"),o=i}}function d(){var e=$(".sidebar-toc"),t=$(".sidebar-toc .current a");if(t[0]&&e[0]){var i=t.offset().top-e.offset().top;n=!!(i>e.height()||i<0)}n&&t.velocity("stop").velocity("scroll",{container:e,offset:-e.height()/2,duration:500,easing:"easeOutQuart"})}function l(){var e=$(".main-inner")[0];e&&(e.getBoundingClientRect().top<s?$(".sidebar-inner").addClass("sticky"):$(".sidebar-inner").removeClass("sticky"))}function f(){var e=$("#footer").offset().top,t=$("#footer")[0].getBoundingClientRect().height,i=$(".sidebar-inner").offset().top,o=$(".sidebar-inner")[0].getBoundingClientRect().height;if(!a&&i+o>e){var n=parseInt($(".sidebar-toc").css("max-height"))-t;a=!0,$(".sidebar-toc").velocity({maxHeight:n},{duration:300,complete:function(){a=!1,r=!1}})}else!r&&!a&&$(window).height()<$("#footer")[0].getBoundingClientRect().top&&(a=!0,$(".sidebar-toc").velocity({maxHeight:"70vh"},{duration:240,complete:function(){a=!1,r=!0}}))}function v(){var e=$(".content"),t=e[0]&&-1*e[0].getBoundingClientRect().top||0,i=parseInt(t/Math.abs(e.height()-$(window).height())*100);i=i>100?100:i<0?0:i,i+="%",$(".sidebar-progress-number").html(i),$(".sidebar-progress-line").css("width",i)}c(),d(),l(),f(),v(),$(window).scroll(function(){c(),d(),l(),f(),v()}),$(".sidebar-nav-toc").on("click",function(){$(".sidebar-nav-toc").toggleClass("current"),$(".sidebar-nav-overview").toggleClass("current"),e.css("display","block"),e.velocity("fadeIn"),t.css("display","none"),t.velocity("fadeOut")}),$(".sidebar-nav-overview").on("click",function(){$(".sidebar-nav-toc").toggleClass("current"),$(".sidebar-nav-overview").toggleClass("current"),e.css("display","none"),e.velocity("fadeOut"),t.css("display","block"),t.velocity("fadeIn")})});