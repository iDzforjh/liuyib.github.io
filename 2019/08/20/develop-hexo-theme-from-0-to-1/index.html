<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><link rel="manifest" href="/manifest.json"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="keywords" content="liuyib, Liuyib's Blog"><meta name="description"><title>从0到1开发Hexo主题杂谈 | Liuyib's Blog</title><meta name="google-site-verification" content="_dxRdKposlAngL4xRoCTrJu0sZ7Pp_RhlBF9inxcD5w"><meta name="msvalidate.01" content="6A508F795A82FADAC671AFCB9848929F"><meta name="baidu-site-verification" content="UYjZUCoORR"><meta name="360-site-verification" content="b926bfcb0e6034f32ac4700700a812f5"><meta name="theme-color" content="#54bcff"><link rel="manifest" href="/manifest.json?v=1.5.2"><link rel="icon" href="/images/icons/favicon-16x16.png?v=1.5.2" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=1.5.2" type="image/png" sizes="32x32"><link rel="alternate" href="/atom.xml" type="application/atom+xml"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" type="text/css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=1.5.2"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="dns-prefetch" href="https://hm.baidu.com"><link rel="dns-prefetch" href="https://tajs.qq.com"><script src="https://www.googletagmanager.com/gtag/js?id=UA-146413033-1" async data-pjax></script><script data-pjax>if("localhost"!==window.location.hostname){function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-146413033-1")}</script><script>var _hmt=_hmt||[];!function(){var t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?2be584e2ddc153d81489b57ba106c8c0",t.async=!0,t.setAttribute("data-pjax","");var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()</script><script>!function(){var t=document.createElement("script");t.src="https://tajs.qq.com/stats?sId=66465986",t.async=!0,t.setAttribute("data-pjax","");var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()</script><script>var Stun=window.Stun||{},CONFIG={root:"/",algolia:void 0,fontawesome:{prefix:"fa"},sidebar:{offsetTop:"30px",renderTocDepth:4},back2top:{enable:!0},reward:!0,fancybox:!1,zoom_image:{enable:!0,mask_color:"rgba(0,0,0,0.6)"},gallery_waterfall:{enable:!0,col_width:"220px",gap_x:"10px",gap_y:"10px"},lazyload:{enable:!0,placeholder:"gif"},pjax:{scrollTo2screen:!0},external_link:{icon:{enable:!0,name:"external-link"}},shortcuts:{switch_post:!0},prompt:{copy_success:"复制成功",copy_error:"复制失败",creative_commons:"知识共享",copy_button:"点击复制"}};window.CONFIG=CONFIG</script></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav"><div class="header-nav-inner"><div class="header-nav-btn fa fa-bars"></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__a" href="/"><i class="fa fa-home"></i>首页</a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__a" href="/archives/"><i class="fa fa-folder-open"></i>归档</a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__a" href="/categories/"><i class="fa fa-th"></i>分类</a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__a" href="/tags/"><i class="fa fa-tags"></i>标签</a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__a" href="/about/"><i class="fa fa-user"></i>关于</a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__a" href="/gallery/"><i class="fa fa-picture-o"></i>相册</a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__a" href="/friends/"><i class="fa fa-hand-spock-o"></i>友链</a></div></div><div class="header-nav-search"><i class="fa fa-search"></i><span>搜索</span></div></div></nav><div class="header-info" style="background:url(https://raw.githubusercontent.com/liuyib/picBed/master/hexo-blog/cover-img/20190911002035.jpg) no-repeat center/cover"><div class="header-info-inner"><div class="header-info-title">Liuyib's Blog</div><div class="header-info-subtitle">write code and love life</div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content"><div class="post"><header class="post-header"><h1 class="post-header-title">从0到1开发Hexo主题杂谈</h1><div class="post-header-meta"><span class="post-header-meta-create"><i class="fa fa-calendar-o"></i><span>发表于 </span><span>2019-08-20</span></span><span class="post-header-meta-update"><i class="fa fa-calendar-check-o"></i><span>更新于 </span><span>2019-09-21</span></span><span class="post-header-meta-word-count"><i class="fa fa-file-word-o"></i><span>字数统计 </span><span>3.8k</span></span><span class="post-header-meta-reading-time"><i class="fa fa-clock-o"></i><span>阅读时长 </span><span>25m</span></span><span class="post-header-meta-reading-count"><i class="fa fa-eye"></i><span>阅读次数 </span><span id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body"><h2 id="前言"><span class="heading-link">前言</span></h2><p>在没有开发自己的 Hexo 主题之前，我都是在 Github Issue 里写<span class="external-link"><a href="https://github.com/liuyib/blog/issues" target="_blank" rel="noopener">博客</a><i class="fa fa-external-link"></i></span>，但这样的做法总被小伙伴各种吐槽 (￣_￣ )。想到如果文章多的时候，使用 Github Issue 浏览起来不够方便，所以还是换回了 Hexo。</p><p>使用 Hexo 首先是要挑选喜欢的主题，以我个人的感受来讲，Hexo 的主题虽然有两百多个，但是能拿出手的也就不到二十个。其中我最佩服的主题 Next 已经足够优秀，但是风格我并不喜欢，最后决定自己开发。</p><p>本文主要记录了我从零开发 Hexo 主题 – <span class="external-link"><a href="https://github.com/liuyib/hexo-theme-stun" target="_blank" rel="noopener">Stun</a><i class="fa fa-external-link"></i></span> 时，遇到的所有坑和经验，<strong>仅供参考</strong>，有不足的地方欢迎指出。</p><a id="more"></a><h2 id="知识储备"><span class="heading-link">知识储备</span></h2><h3 id="模板引擎"><span class="heading-link">模板引擎</span></h3><p>传统的 HTML 写起来既不方便，又不能复用，因此在 Hexo 中通常使用模板引擎来呈现网站内容。</p><p>常用的几种模板引擎有：<span class="external-link"><a href="https://github.com/paularmstrong/swig" target="_blank" rel="noopener">Swig</a><i class="fa fa-external-link"></i></span>、<span class="external-link"><a href="https://github.com/hexojs/hexo-renderer-ejs" target="_blank" rel="noopener">EJS</a><i class="fa fa-external-link"></i></span>、<span class="external-link"><a href="https://github.com/hexojs/hexo-renderer-haml" target="_blank" rel="noopener">Haml</a><i class="fa fa-external-link"></i></span> 或 <span class="external-link"><a href="https://github.com/hexojs/hexo-renderer-jade" target="_blank" rel="noopener">Jade</a><i class="fa fa-external-link"></i></span>。其中 Jade 由于商标问题，改名为 <span class="external-link"><a href="https://github.com/pugjs/pug" target="_blank" rel="noopener">Pug</a><i class="fa fa-external-link"></i></span>，虽然它们是兼容的，但使用的时候，推荐安装 Pug 而不是 Jade。Hexo 内置了 Swig，将文件扩展名改为 <code>.swig</code> 即可使用，你也可以安装插件来获得另外几种模板引擎的支持，Hexo 会根据文件扩展名来决定使用哪一种。例如：</p><figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">layout.pug   -- 使用 pug</span><br><span class="line">layout.swig  -- 使用 swig</span><br></pre></td></tr></tbody></table></div></figure><p>这里你需要做的是，选择一个自己喜欢的模板引擎，然后浏览文档，了解这个模板引擎的基本用法。</p><ul><li>英文文档地址分别如下：<span class="external-link"><a href="https://node-swig.github.io/swig-templates/docs/" target="_blank" rel="noopener">Swig</a><i class="fa fa-external-link"></i></span>、<span class="external-link"><a href="https://ejs.co/#docs" target="_blank" rel="noopener">EJS</a><i class="fa fa-external-link"></i></span>、<span class="external-link"><a href="https://pugjs.org/api/getting-started.html" target="_blank" rel="noopener">Pug</a><i class="fa fa-external-link"></i></span>、<span class="external-link"><a href="http://haml.info/docs.html" target="_blank" rel="noopener">Haml</a><i class="fa fa-external-link"></i></span>。</li><li>中文文档地址分别如下：<span class="external-link"><a href="https://myvin.github.io/swig.zh-CN/docs/index.html" target="_blank" rel="noopener">Swig</a><i class="fa fa-external-link"></i></span>、<span class="external-link"><a href="https://ejs.bootcss.com/#docs" target="_blank" rel="noopener">EJS</a><i class="fa fa-external-link"></i></span>、<span class="external-link"><a href="https://pugjs.org/zh-cn/api/getting-started.html" target="_blank" rel="noopener">Pug</a><i class="fa fa-external-link"></i></span>、Haml（无）。</li></ul><p>这里我选择了 Pug，不过推荐使用 Swig 或 EJS。</p><h3 id="css-预处理语言"><span class="heading-link">CSS 预处理语言</span></h3><p>你可以使用原生 CSS 来写样式，但是原生 CSS 不能使用变量，不能复用，也没有函数，这会导致主题开发变得相对麻烦，甚至某些功能无法实现，因此最好是使用 CSS 预处理语言。</p><p>常见的 CSS 预处理语言有：<span class="external-link"><a href="http://lesscss.org/" target="_blank" rel="noopener">Less</a><i class="fa fa-external-link"></i></span>、<span class="external-link"><a href="https://sass-lang.com/" target="_blank" rel="noopener">Sass</a><i class="fa fa-external-link"></i></span>、<span class="external-link"><a href="http://stylus-lang.com/" target="_blank" rel="noopener">Stylus</a><i class="fa fa-external-link"></i></span>。至于它们的选择，根据自己的喜好即可。Hexo 默认使用的是 Stylus，它的功能足够强大，完全够用，因此我选用了 Stylus。</p><h3 id="hexo-相关知识"><span class="heading-link">Hexo 相关知识</span></h3><p>有关 Hexo 的知识，这里只列举必要的部分。</p><h4 id="构建-hexo-开发环境"><span class="heading-link">构建 Hexo 开发环境</span></h4><p>开发主题之前，你需要搭建自己的 Hexo 工作目录，有两种方式可供选择：</p><ol><li>使用 <code>hexo-cli</code></li><li>克隆 Hexo 主题的单元测试项目</li></ol><p>第一种方式，去 Hexo <span class="external-link"><a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">官网</a><i class="fa fa-external-link"></i></span>，按照提示安装 <code>hexo-cli</code> 并生成你的 Hexo 工作目录，目录主要部分如下：</p><figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── scaffolds</span><br><span class="line">├── source</span><br><span class="line">|   └── _posts</span><br><span class="line">├── themes</span><br><span class="line">├── .gitignore</span><br><span class="line">├── _config.yml</span><br><span class="line">└── package.json</span><br></pre></td></tr></tbody></table></div></figure><p>第二种方式，克隆 Hexo 官方的<span class="external-link"><a href="https://github.com/hexojs/hexo-theme-unit-test" target="_blank" rel="noopener">单元测试库</a><i class="fa fa-external-link"></i></span>，这样会得到同上的文件目录。然后执行指令 <code>npm install</code> 安装所有依赖。</p><p>对于一般的 Hexo 用户，都是使用第一种方式。不过对于 Hexo 主题开发者来说，如果你的主题将来要发布到 Hexo 的<span class="external-link"><a href="https://hexo.io/themes" target="_blank" rel="noopener">主题列表</a><i class="fa fa-external-link"></i></span>，建议直接在 Hexo 的主题单元测试项目中进行开发，也就是第二种方式。原因是因为 Hexo 建议在主题发布前，先进行主题单元测试，确保每一项功能都能正常使用。Hexo 提供的单元测试库包括了所有的边缘情况，直接在上面开发就可以在开发时注意到这些边缘情况，而不是开发完再去测试。</p><p>搭建完 Hexo 开发环境后，需要安装相关插件来支持你所使用的渲染引擎。Hexo 默认安装的渲染引擎是 EJS 和 Stylus，并且 Hexo 内置了 Swig，因此，如果你选用了 <code>EJS + Stylus</code> 或 <code>Swig + Stylus</code>，那么可以忽略这段，如果你选择了其他的渲染引擎，需要自行选择安装：</p><figure class="highlight bash"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Templates</span></span><br><span class="line">$ npm install --save hexo-renderer-ejs</span><br><span class="line">$ npm install --save hexo-render-pug</span><br><span class="line">$ npm install --save hexo-render-haml</span><br><span class="line"></span><br><span class="line"><span class="comment"># Styles</span></span><br><span class="line">$ npm install --save hexo-renderer-less</span><br><span class="line">$ npm install --save hexo-renderer-sass</span><br><span class="line">$ npm install --save hexo-renderer-stylus</span><br></pre></td></tr></tbody></table></div></figure><h4 id="生成主题结构目录"><span class="heading-link">生成主题结构目录</span></h4><p>上一步只是搭建好了 Hexo 工作目录，接下来是创建主题的文件目录，你可以参考着已有的主题的文件目录手动创建，也可以使用 <code>Yeoman</code> 自动生成，使用 <code>Yeoman</code> 自动生成的步骤如下。</p><ol><li>安装</li></ol><figure class="highlight bash"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ npm install --global yo</span><br><span class="line">$ npm install --global generator-hexo-theme</span><br></pre></td></tr></tbody></table></div></figure><ol start="2"><li>生成</li></ol><p>进入 Hexo 的 <code>themes</code> 目录中，新建一个文件夹作为你的主题目录，然后进入该文件夹中，执行指令：</p><figure class="highlight bash"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yo hexo-theme</span><br></pre></td></tr></tbody></table></div></figure><p>按照提示，填写或选择相应的信息，如下图：</p><p><img src="/images/loading.svg" alt class="lazyload gif" data-src="https://raw.githubusercontent.com/liuyib/picBed/master/hexo-theme-stun/doc/20190822211939.png"></p><p>生成的文件目录如下：</p><figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── layout        # 布局文件夹</span><br><span class="line">|   ├── includes</span><br><span class="line">|   |   ├── layout.pug       # 页面总体布局</span><br><span class="line">|   |   └── recent-posts.pug # 文章列表</span><br><span class="line">|   ├── index.pug            # 首页</span><br><span class="line">|   ├── archive.pug          # 归档页</span><br><span class="line">|   ├── category.pug         # 分类页</span><br><span class="line">|   ├── tag.pug              # 标签页</span><br><span class="line">|   ├── post.pug             # 文章页</span><br><span class="line">|   └── page.pug             # 除以上页面之外的页面</span><br><span class="line">├── scripts       # 脚本文件夹</span><br><span class="line">├── source        # 资源文件夹</span><br><span class="line">|   ├── css</span><br><span class="line">|   ├── js</span><br><span class="line">|   └── favicon.ico</span><br><span class="line">├── .editorconfig # 编辑器配置文件</span><br><span class="line">├── _config.yml   # 主题配置文件</span><br><span class="line">└── package.json</span><br></pre></td></tr></tbody></table></div></figure><p>当然只有这些文件目录是不够的，我们还需要另外添加一些其他的文件或目录，例如，<code>languages</code> 目录，放置语言文件，用于<span class="external-link"><a href="https://hexo.io/zh-cn/docs/internationalization" target="_blank" rel="noopener">国际化（i18n）</a><i class="fa fa-external-link"></i></span>设置（如果想要你的主题支持多语言，就需要添加该目录）。</p><p>有关以上目录的介绍，详参见：<span class="external-link"><a href="https://hexo.io/zh-cn/docs/themes" target="_blank" rel="noopener">Hexo 主题</a><i class="fa fa-external-link"></i></span>。</p><p>这里需要提一下，主题目录和 Hexo 根目录中各有一个 <code>source</code> 文件夹，当你执行指令 <code>hexo generate</code> 来生成静态文件时，这两个 <code>source</code> 目录中的文件如果是 Markdown 会被解析为 HTML，其他不能解析的文件，会被复制到 <code>public</code> 目录中。<code>public</code> 目录用于存放生成的静态文件，这些静态文件就是线上跑的网站文件。因此，如果你不清楚 <code>source</code> 目录里文件的使用路径是怎样的，那么你可以跑一下指令 <code>hexo generate</code>，这些文件生成到 <code>public</code> 目录中后，它们的路径关系就很明显了。</p><h4 id="通读文档"><span class="heading-link">通读文档</span></h4><p>虽然 Hexo 的文档确实很差劲，文档下面的评论区全是吐槽，而且有些部分中英文版本没有同步，但是如果能耐心读完，会有很大的收益，我个人的最大感受是 Hexo 的文档真的特别重要。当然一次掌握是不可能的，最好在开发时每隔一段时间过一遍。</p><p>刚开始开发主题，不可能理解 Hexo 文档中提到的所有地方，但是有两个点必须首先掌握：<span class="external-link"><a href="https://hexo.io/zh-cn/docs/variables" target="_blank" rel="noopener">变量</a><i class="fa fa-external-link"></i></span>和<span class="external-link"><a href="https://hexo.io/zh-cn/docs/helpers" target="_blank" rel="noopener">辅助函数</a><i class="fa fa-external-link"></i></span>，这两点在开发时会经常用到，并且贯穿整个开发过程。</p><h2 id="主题开发"><span class="heading-link">主题开发</span></h2><p>有了上述的准备后，就可以开始主题的开发了。下面是主题开发中一些值得注意的地方，了解这些，可以帮助你避免踩重复的坑。</p><h3 id="主题配置文件"><span class="heading-link">主题配置文件</span></h3><p>主题的配置文件采用了 <span class="external-link"><a href="https://docs.ansible.com/ansible/latest/reference_appendices/YAMLSyntax.html" target="_blank" rel="noopener">Yaml</a><i class="fa fa-external-link"></i></span> 语法，和 Json 类似，了解一下语法格式就可以上手使用了。</p><p>开发主题时，有的功能可以让用户自己配置，因此我们需要将这些功能的配置项暴露出来，填充到主题的配置文件 <code>_config.yml</code> 中。然后在模板引擎中，你可以通过 Hexo 内置的 <code>theme</code> 变量来获取这些配置项。例如：</p><p>配置文件：</p><figure class="highlight yaml"><figcaption><span>_config.yml</span></figcaption><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">copyright:</span></span><br><span class="line"><span class="attr">  enable:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  text:</span></span><br></pre></td></tr></tbody></table></div></figure><p>这样使用：</p><figure class="highlight html"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// -------------------- Pug 语法 --------------------</span><br><span class="line">if theme.copyright.enable</span><br><span class="line">  div.copyright= theme.copyright.text</span><br><span class="line"></span><br><span class="line">// -------------------- Swig 语法 --------------------</span><br><span class="line">{% if theme.copyright.enable %}</span><br><span class="line"><span class="tag"><<span class="name">div</span> <span class="attr">class</span>=<span class="string">"copyright"</span>></span>{{ theme.copyright.text }}<span class="tag"></<span class="name">div</span>></span></span><br><span class="line">{% endif %}</span><br></pre></td></tr></tbody></table></div></figure><div class="note-plugin default"><p>后面的文章中，模板语言示例代码都会用 Pug 和 Swig 两种语法给出。</p></div><p>随着项目的发展，配置文件会越来越大，上面这种做法的缺点也会越来越明显。</p><ul><li><p>对于使用者</p><p>当更新主题时，由于配置文件会被覆盖，因此用户必须提前将配置文件备份，等更新完主题后再将备份的数据拷贝回去，这个过程繁琐又容易出错。</p></li><li><p>对于开发者</p><p>在发布主题时，开发者不可能将自己测试用的数据保留在主题配置文件中，而应该预留一份干净的配置文件。因此每次发布主题之前，都需要把主题配置文件里的测试数据清空、备份，然后等发布完主题后再恢复回来。这种做法是无法令人忍受的，因为每次 <code>git commit</code> 之前都需要这样做一次。</p></li></ul><p>因此我们需要一种更友好的方式来使用配置文件。在查找资料和参考现有主题 NexT、Melody 的实现后，发现可以利用 Hexo 3.0 提供的新特性 – <span class="external-link"><a href="https://hexo.io/zh-cn/docs/data-files" target="_blank" rel="noopener">数据文件</a><i class="fa fa-external-link"></i></span>，来解决上面的痛点。</p><p>使用方法如下，在 Hexo 根目录下的 <code>source/_data</code> 文件夹中（没有的文件夹需要自己创建），新建一个 Yaml 配置文件，并<strong>命名为主题的名称</strong>，例如 Stun 主题，就叫做 <code>stun.yml</code>。然后将主题配置文件 <code>_config.yml</code> 里的内容复制到 <code>stun.yml</code> 中，这样 <code>stun.yml</code> 就会覆盖 <code>_config.yml</code>。如果想要修改配置，直接修改 <code>stun.yml</code> 就好了。当用户更新主题或者开发者发布主题时，配置数据保存在 <code>stun.yml</code> 中，主题原来的配置文件 <code>_config.yml</code> 仍然是干净的。</p><p>下面是代码实现，在主题根目录下的 <code>scripts</code> 文件夹中（没有就新建），添加一个 JS 文件，文件名随意，添加如下代码：</p><figure class="highlight js"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">hexo.on(<span class="string">'generateBefore'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span><br><span class="line">  <span class="keyword">var</span> rootConfig = hexo.config;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (hexo.locals.get) {</span><br><span class="line">    <span class="comment">// 获取 source/_data 目录下的文件</span></span><br><span class="line">    <span class="keyword">var</span> data = hexo.locals.get(<span class="string">'data'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果存在 stun.yml 文件，就用它覆盖原来的配置文件</span></span><br><span class="line">    <span class="keyword">if</span> (data && data.stun) {</span><br><span class="line">      hexo.theme.config = data.stun;</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  hexo.theme.config.rootConfig = rootConfig;</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></div></figure><h3 id="页面搭建"><span class="heading-link">页面搭建</span></h3><p>你需要分析主题页面的结构，将能够公用的部分抽离出来，例如：</p><ul><li>HTML 的 <code>head</code> 部分</li><li>顶部导航栏</li><li>页面头部、底部</li><li>页面侧边栏</li><li>页面主体部分（显示文章的地方）</li><li>…</li></ul><p>将这些部分对应的代码放在主题 <code>layout</code> 目录下的 <code>layout.pug</code> 文件中用以复用，例如：</p><figure class="highlight html"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">// -------------------- Pug 语法 --------------------</span><br><span class="line">html</span><br><span class="line">  head</span><br><span class="line">    title</span><br><span class="line">      block title</span><br><span class="line">  body</span><br><span class="line">    header#header.header</span><br><span class="line">      div.header-inner</span><br><span class="line">        include ./header.pug</span><br><span class="line">    </span><br><span class="line">    main#main.main</span><br><span class="line">      div.main-inner</span><br><span class="line">        div#content.content</span><br><span class="line">          div.content-inner</span><br><span class="line">            block content</span><br><span class="line">        </span><br><span class="line">        div#sidebar.sidebar</span><br><span class="line">          div.sidebar-inner</span><br><span class="line">            block sidebar</span><br><span class="line"></span><br><span class="line">    footer#footer.footer</span><br><span class="line">      div.footer-inner</span><br><span class="line">        include ./footer.pug</span><br><span class="line"></span><br><span class="line">// -------------------- Swig 语法 --------------------</span><br><span class="line"><span class="tag"><<span class="name">html</span>></span></span><br><span class="line">  <span class="tag"><<span class="name">head</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">title</span>></span>{% block title %}{% endblock %}<span class="tag"></<span class="name">title</span>></span></span><br><span class="line">  <span class="tag"></<span class="name">head</span>></span></span><br><span class="line"></span><br><span class="line">  <span class="tag"><<span class="name">body</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">header</span> <span class="attr">id</span>=<span class="string">"header"</span> <span class="attr">class</span>=<span class="string">"header"</span>></span></span><br><span class="line">      <span class="tag"><<span class="name">div</span> <span class="attr">class</span>=<span class="string">"header-inner"</span>></span></span><br><span class="line">        {% include './header.swig' %}</span><br><span class="line">      <span class="tag"></<span class="name">div</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">header</span>></span></span><br><span class="line"></span><br><span class="line">    <span class="tag"><<span class="name">main</span> <span class="attr">id</span>=<span class="string">"main"</span> <span class="attr">class</span>=<span class="string">"main"</span>></span></span><br><span class="line">      <span class="tag"><<span class="name">div</span> <span class="attr">class</span>=<span class="string">"main-inner"</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">div</span> <span class="attr">id</span>=<span class="string">"content"</span> <span class="attr">class</span>=<span class="string">"content"</span>></span></span><br><span class="line">          <span class="tag"><<span class="name">div</span> <span class="attr">class</span>=<span class="string">"content-inner"</span>></span></span><br><span class="line">            {% block content %}{% endblock %}</span><br><span class="line">          <span class="tag"></<span class="name">div</span>></span></span><br><span class="line">        <span class="tag"></<span class="name">div</span>></span></span><br><span class="line">        </span><br><span class="line">        <span class="tag"><<span class="name">div</span> <span class="attr">id</span>=<span class="string">"sidebar"</span> <span class="attr">class</span>=<span class="string">"sidebar"</span>></span></span><br><span class="line">          <span class="tag"><<span class="name">div</span> <span class="attr">class</span>=<span class="string">"sidebar-inner"</span>></span></span><br><span class="line">            {% block sidebar %}{% endblock %}</span><br><span class="line">          <span class="tag"></<span class="name">div</span>></span></span><br><span class="line">        <span class="tag"></<span class="name">div</span>></span></span><br><span class="line">      <span class="tag"></<span class="name">div</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">main</span>></span></span><br><span class="line"></span><br><span class="line">    <span class="tag"><<span class="name">footer</span> <span class="attr">id</span>=<span class="string">"footer"</span> <span class="attr">class</span>=<span class="string">"footer"</span>></span></span><br><span class="line">      <span class="tag"><<span class="name">div</span> <span class="attr">class</span>=<span class="string">"footer-inner"</span>></span></span><br><span class="line">        {% include './footer.swig' %}</span><br><span class="line">      <span class="tag"></<span class="name">div</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">footer</span>></span></span><br><span class="line">  <span class="tag"></<span class="name">body</span>></span></span><br><span class="line"><span class="tag"></<span class="name">html</span>></span></span><br></pre></td></tr></tbody></table></div></figure><p><code>layout.pug</code> 是网站最基础的布局代码，所有的页面都是继承它而来。Pug / Swig 使用 <code>extends</code> 和 <code>block</code> 实现继承，例如：</p><figure class="highlight html"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">// -------------------- Pug 语法 --------------------</span><br><span class="line">html</span><br><span class="line">  head</span><br><span class="line">    title</span><br><span class="line">      block title</span><br><span class="line"></span><br><span class="line">  body</span><br><span class="line">    block content</span><br><span class="line"></span><br><span class="line">// -------------------- Swig 语法 --------------------</span><br><span class="line"><span class="tag"><<span class="name">html</span>></span></span><br><span class="line">  <span class="tag"><<span class="name">head</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">title</span>></span>{% block title %}{% endblock %}<span class="tag"></<span class="name">title</span>></span></span><br><span class="line">  <span class="tag"></<span class="name">head</span>></span></span><br><span class="line">  <span class="tag"><<span class="name">body</span>></span></span><br><span class="line">    {% block content %}{% endblock %}</span><br><span class="line">  <span class="tag"></<span class="name">body</span>></span></span><br><span class="line"><span class="tag"></<span class="name">html</span>></span></span><br></pre></td></tr></tbody></table></div></figure><figure class="highlight html"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// -------------------- Pug 语法 --------------------</span><br><span class="line">extends layout.pug</span><br><span class="line"></span><br><span class="line">block title</span><br><span class="line">  My Page</span><br><span class="line"></span><br><span class="line">block content</span><br><span class="line">  This is a awesome page.</span><br><span class="line"></span><br><span class="line">// -------------------- Swig 语法 --------------------</span><br><span class="line">{% extends 'layout.swig' %}</span><br><span class="line"></span><br><span class="line">{% block title %}My Page{% endblock %}</span><br><span class="line"></span><br><span class="line">{% block content %}</span><br><span class="line"><span class="tag"><<span class="name">p</span>></span>This is a awesome page.<span class="tag"></<span class="name">p</span>></span></span><br><span class="line">{% endblock %}</span><br></pre></td></tr></tbody></table></div></figure><p>除了继承的方式复用代码，还可以通过 <code>include</code> 语法直接引文件来实现代码复用，例如：</p><figure class="highlight html"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// -------------------- Pug 语法 --------------------</span><br><span class="line">div#header.header</span><br><span class="line">  include ./header.pug</span><br><span class="line"></span><br><span class="line">// -------------------- Swig 语法 --------------------</span><br><span class="line"><span class="tag"><<span class="name">div</span> <span class="attr">id</span>=<span class="string">"header"</span> <span class="attr">class</span>=<span class="string">"header"</span>></span></span><br><span class="line">  {% include './header.swig' %}</span><br><span class="line"><span class="tag"></<span class="name">div</span>></span></span><br></pre></td></tr></tbody></table></div></figure><blockquote><p>由于 <code>layout.pug</code> 只用于被其他页面继承，并不会单独渲染成页面，因此，可以将文件名改为 <code>_layout.pug</code>（以下划线开头）这样 Hexo 就不会解析这个文件，可以提高 Hexo 生成页面的速度。</p></blockquote><p>这里我并不准备介绍页面中更详细的部分如何实现，直接看<span class="external-link"><a href="https://github.com/liuyib/hexo-theme-stun" target="_blank" rel="noopener">源码</a><i class="fa fa-external-link"></i></span>效果更好。</p><h3 id="数据交互"><span class="heading-link">数据交互</span></h3><p>这里介绍下 Pug / Swig、Stylus、JavaScript 这几种文件如何与主题配置文件进行数据交互。</p><p>前面我们已经知道了，主题配置文件里的配置项被包含在 <code>theme</code> 变量下。因此在我们需要知道如何在另外三种文件中使用 <code>theme</code> 变量：</p><ul><li><p>在 Pug / Swig 文件中使用</p><figure class="highlight html"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">// -------------------- Pug 语法 --------------------</span><br><span class="line">div= theme.copyright.text</span><br><span class="line"></span><br><span class="line">html(lang=theme.language)</span><br><span class="line"></span><br><span class="line">if theme.sidebar.enable</span><br><span class="line">  div.sidebar</span><br><span class="line"></span><br><span class="line">div(class=`sidebar ${ if theme.sidebar.show ? 'show' : '' }`)</span><br><span class="line"></span><br><span class="line">// -------------------- Swig 语法 --------------------</span><br><span class="line"><span class="tag"><<span class="name">div</span>></span>{{ theme.copyright.text }}<span class="tag"></<span class="name">div</span>></span></span><br><span class="line"></span><br><span class="line"><span class="tag"><<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"{{ theme.language }}"</span>></span><span class="tag"></<span class="name">html</span>></span></span><br><span class="line"></span><br><span class="line">{% if theme.sidebar.enable %}</span><br><span class="line">  <span class="tag"><<span class="name">div</span> <span class="attr">class</span>=<span class="string">"sidebar"</span>></span><span class="tag"></<span class="name">div</span>></span></span><br><span class="line">{% endif %}</span><br><span class="line"></span><br><span class="line"><span class="tag"><<span class="name">div</span> <span class="attr">class</span>=<span class="string">"sidebar {% if theme.sidebar.show %}show{% endif %}"</span>></span><span class="tag"></<span class="name">div</span>></span></span><br></pre></td></tr></tbody></table></div></figure></li><li><p>在 Stylus 文件中使用</p><p>需要通过 Hexo 内置的函数 <code>hexo-config</code> 来获取 <code>theme</code> 变量中的属性，但是不需要写 <code>theme</code>：</p><figure class="highlight stylus"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// back2top 是 theme 变量下的一个属性</span></span><br><span class="line"><span class="keyword">if</span> (hexo-config(<span class="string">'back2top.enable'</span>))</span><br><span class="line">  .back2top</span><br><span class="line">    <span class="attribute">display</span>: block</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果配置项的值中含有样式，需要使用 Stylus 的 convert 函数转换一下</span></span><br><span class="line">.post-title</span><br><span class="line">  <span class="attribute">color</span>: convert(hexo-config(<span class="string">'post.title.color'</span>))</span><br></pre></td></tr></tbody></table></div></figure></li><li><p>在 JavaScript 文件中使用</p><p>在 JS 文件中没有办法直接获取到 Hexo 内置的 <code>theme</code> 变量，但是我们可以换一种方式来间接获取。新建一个模板引擎文件，我们就叫它 <code>config.pug</code>，文件内容如下所示：</p><figure class="highlight html"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">// ----- Pug 语法（注意 script 标签后面的点，表示该标签后面有多行代码）-----</span><br><span class="line">script.</span><br><span class="line">  var CONFIG = {</span><br><span class="line">    sidebar: '!{ theme.sidebar }',</span><br><span class="line">    back2top: '!{ theme.back2top }',</span><br><span class="line">    ...</span><br><span class="line">  };</span><br><span class="line"></span><br><span class="line">  window.CONFIG = CONFIG;</span><br><span class="line"></span><br><span class="line">// -------------------- Swig 语法 --------------------</span><br><span class="line"><span class="tag"><<span class="name">script</span>></span><span class="undefined"></span></span><br><span class="line"><span class="actionscript">  <span class="keyword">var</span> CONFIG = {</span></span><br><span class="line"><span class="handlebars"><span class="xml">    sidebar: </span><span class="template-variable">{{ theme.sidebar | json_encode }}</span><span class="xml">,</span></span></span><br><span class="line"><span class="handlebars"><span class="xml">    back2top: </span><span class="template-variable">{{ theme.back2top | json_encode }}</span><span class="xml">,</span></span></span><br><span class="line"><span class="undefined">    ...</span></span><br><span class="line"><span class="undefined">  };</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="built_in">window</span>.CONFIG = CONFIG;</span></span><br><span class="line"><span class="undefined"></span><span class="tag"></<span class="name">script</span>></span></span><br></pre></td></tr></tbody></table></div></figure><p>然后将 <code>config.pug</code> 文件放在 HTML 的 <code>head</code> 标签中加载，这样就可以通过全局变量 <code>CONFIG</code> 在 JS 中获取主题配置文件里的数据了。</p></li></ul><p>到这里为止，就介绍完了开发 Hexo 主题前必要的知识储备，剩下的就靠开发者自己完成了。</p><h2 id="发布主题"><span class="heading-link">发布主题</span></h2><p>发布主题之前你需要进行<span class="external-link"><a href="https://github.com/hexojs/hexo-theme-unit-test" target="_blank" rel="noopener">主题单元测试</a><i class="fa fa-external-link"></i></span>，确保每一项功能都能正常使用。如果你是按照我之前介绍的方法，直接 Hexo 的主题单元测试库中开发主题，那么你应该就不需要进行这一步了。</p><p>1、Fork <span class="external-link"><a href="https://github.com/hexojs/site" target="_blank" rel="noopener">hexojs/site</a><i class="fa fa-external-link"></i></span><br>2、编辑 <code>source/_data/themes.yml</code>，在文件中新增您的主题：</p><figure class="highlight yaml"><figcaption><span>themes.yml</span></figcaption><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">- name:</span> <span class="string">Stun</span></span><br><span class="line"><span class="attr">  description:</span> <span class="string">A</span> <span class="string">beautiful</span> <span class="string">&</span> <span class="string">simple</span> <span class="string">theme</span></span><br><span class="line"><span class="attr">  link:</span> <span class="attr">https://github.com/liuyib/hexo-theme-stun</span></span><br><span class="line"><span class="attr">  preview:</span> <span class="attr">https://liuyib.github.io/</span></span><br><span class="line"><span class="attr">  tags:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">responsive</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">beautiful</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">simple</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">two_column</span></span><br></pre></td></tr></tbody></table></div></figure><p>3、在 <code>source/themes/screenshots</code> 中添加一个和你主题同名的图片，图片必须为 800*500 的 PNG 文件。<br>4、发起新的合并申请（pull request）。</p><p>最后，只需要等待 Hexo 仓库的维护人员收录你的主题即可。</p><hr><p>参考链接：</p><ul><li><span class="external-link"><a href="https://molunerfinn.com/make-a-hexo-theme/" target="_blank" rel="noopener">Hexo主题开发经验杂谈</a><i class="fa fa-external-link"></i></span></li><li><span class="external-link"><a href="http://chensd.com/2016-06/hexo-theme-guide.html" target="_blank" rel="noopener">Hexo 主题开发指南</a><i class="fa fa-external-link"></i></span></li></ul></div><footer class="post-footer"><div class="post-end"><span>------ </span><span>本文结束，感谢您的阅读</span><span> ------</span></div><div class="post-copyright"><div class="post-copyright-author"><span class="post-copyright-author-name">本文作者: </span><span class="post-copyright-author-value"><a href="https://liuyib.github.io">liuyib</a></span></div><div class="post-copyright-link"><span class="post-copyright-link-name">本文链接: </span><span class="post-copyright-link-value"><a href="https://liuyib.github.io/2019/08/20/develop-hexo-theme-from-0-to-1/">https://liuyib.github.io/2019/08/20/develop-hexo-theme-from-0-to-1/</a></span></div><div class="post-copyright-notice"><span class="post-copyright-notice-name">版权声明: </span><span class="post-copyright-notice-value">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="external nofollow" target="_blank">BY-NC-SA</a> 许可协议。转载请注明出处！</span></div></div><div class="post-tags"><span class="post-tags-item"><i class="post-tags-item__i fa fa-tags"></i><a class="post-tags-item__a" href="https://liuyib.github.io/tags/hexo/">hexo</a></span><span class="post-tags-item"><i class="post-tags-item__i fa fa-tags"></i><a class="post-tags-item__a" href="https://liuyib.github.io/tags/hexo-theme/">hexo-theme</a></span></div><div class="reward"><div class="reward-button">请我喝杯咖啡~</div><div class="reward-qr"><span class="reward-qr-alipay"><img class="reward-qr-alipay__img" src="https://raw.githubusercontent.com/liuyib/picBed/master/hexo-blog/20190529222805.png"><div class="reward-qr-alipay-text">支付宝打赏</div></span><span class="reward-qr-wechat"><img class="reward-qr-wechat__img" src="https://raw.githubusercontent.com/liuyib/picBed/master/hexo-blog/20190529222806.png"><div class="reward-qr-wechat-text">微信打赏</div></span></div></div><nav class="paginator"><div class="paginator-post"><div class="paginator-post-next"><a class="paginator-post-next__a" href="/2019/07/26/theme-stun-gitter/"><span>theme-stun-gitter</span><i class="fa fa-chevron-right"></i></a></div></div></nav></footer></div></div><div class="comments" id="comments"><div id="gitalk-container"></div></div></div><aside class="sidebar" id="sidebar"><div class="sidebar-inner"><div class="sidebar-nav"><span class="sidebar-nav-toc current">文章目录</span><span class="sidebar-nav-ov">站点概览</span></div><section class="sidebar-toc"><div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#前言"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#知识储备"><span class="toc-number">2.</span> <span class="toc-text">知识储备</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#模板引擎"><span class="toc-number">2.1.</span> <span class="toc-text">模板引擎</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#css-预处理语言"><span class="toc-number">2.2.</span> <span class="toc-text">CSS 预处理语言</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hexo-相关知识"><span class="toc-number">2.3.</span> <span class="toc-text">Hexo 相关知识</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#构建-hexo-开发环境"><span class="toc-number">2.3.1.</span> <span class="toc-text">构建 Hexo 开发环境</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#生成主题结构目录"><span class="toc-number">2.3.2.</span> <span class="toc-text">生成主题结构目录</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#通读文档"><span class="toc-number">2.3.3.</span> <span class="toc-text">通读文档</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#主题开发"><span class="toc-number">3.</span> <span class="toc-text">主题开发</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#主题配置文件"><span class="toc-number">3.1.</span> <span class="toc-text">主题配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#页面搭建"><span class="toc-number">3.2.</span> <span class="toc-text">页面搭建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据交互"><span class="toc-number">3.3.</span> <span class="toc-text">数据交互</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#发布主题"><span class="toc-number">4.</span> <span class="toc-text">发布主题</span></a></li></ol></div></section><section class="sidebar-ov hide"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="https://raw.githubusercontent.com/liuyib/picBed/master/hexo-blog/20190528162910.jpg" alt="avatar"></div><p class="sidebar-ov-author__p">write code and love life</p></div><div class="sidebar-ov-social"><a class="sidebar-ov-social__item" href="https://github.com/liuyib/" target="_blank" rel="noopener" data-popover="Github" data-popover-pos="up"><i class="sidebar-ov-social__item--icon fa fa-github"></i></a><a class="sidebar-ov-social__item" href="https://segmentfault.com/u/liuyib/" target="_blank" rel="noopener" data-popover="思否" data-popover-pos="up"><span class="sidebar-ov-social__item--logo">sf</span></a><a class="sidebar-ov-social__item" href="https://www.zhihu.com/people/liu-yibo-64-65/activities/" target="_blank" rel="noopener" data-popover="知乎" data-popover-pos="up"><span class="sidebar-ov-social__item--logo">知</span></a><a class="sidebar-ov-social__item" href="https://juejin.im/user/5ad6b350f265da2397076275/" target="_blank" rel="noopener" data-popover="掘金" data-popover-pos="up"><span class="sidebar-ov-social__item--logo">掘</span></a></div><div class="sidebar-ov-feed"><span class="sidebar-ov-feed-email"><a class="sidebar-ov-feed-email__a" href="http://eepurl.com/guAE6j" target="_blank" rel="noopener"><i class="sidebar-ov-feed-email__a--icon fa fa-envelope"></i><span>Email </span><span>订阅</span></a></span><span class="sidebar-ov-feed-rss"><a class="sidebar-ov-feed-rss__a" href="/atom.xml" target="_blank" rel="noopener"><i class="sidebar-ov-feed-rss__a--icon fa fa-rss"></i><span>RSS </span><span>订阅</span></a></span></div><div class="sidebar-ov-state"><a class="sidebar-ov-state__a posts" href="/archives/"><div class="sidebar-ov-state__a--count">3</div><div class="sidebar-ov-state__a--name">归档</div></a><a class="sidebar-ov-state__a categories" href="/categories/"><div class="sidebar-ov-state__a--count">2</div><div class="sidebar-ov-state__a--name">分类</div></a><a class="sidebar-ov-state__a tags" href="/tags/"><div class="sidebar-ov-state__a--count">6</div><div class="sidebar-ov-state__a--name">标签</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" data-popover="知识共享" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg" alt="知识共享"></a></div></section><div class="sidebar-reading"><div class="sidebar-reading-info"><span>你已阅读了 </span><span class="sidebar-reading-info-num">0</span></div><div class="sidebar-reading-line"></div></div></div></aside><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>© 2019</span><span class="fa fa-heart footer-icon"></span><span>liuyib. All Rights Reserved.</span></div><div><span>由 <a href="http://hexo.io/" title="hexo" target="_blank" rel="noopener">hexo</a> 强力驱动</span><span> v3.9.0.</span><span class="separator">|</span><span>主题 - <a href="https://github.com/liuyib/hexo-theme-stun/" title="stun" target="_blank" rel="noopener">stun</a></span><span> v1.5.2.</span></div><div class="busuanzi"><span class="busuanzi-site_uv"><i class="fa fa-user"></i><span>访问人数 </span><span id="busuanzi_value_site_uv"></span></span><span class="separator">|</span><span class="busuanzi-site_pv"><i class="fa fa-eye"></i><span>浏览总量 </span><span id="busuanzi_value_site_pv"></span></span><script src="https://cdn.jsdelivr.net/gh/sukkaw/busuanzi@latest/bsz.pure.mini.js" async></script></div><div><span>托管于 <a href="https://pages.github.com/" rel="noopener" target="_blank">Github Pages</a></span></div></div></footer><div class="loading-bar" id="loading-bar"><div class="progress"></div></div><div class="back2top" id="back2top"><i class="back2top-icon fa fa-rocket"></i></div></div><div class="search-mask"></div><div class="search-popup"><span class="search-close"></span><div class="search-input"><input placeholder="搜索文章"></div><div class="search-results"></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="https://cdn.jsdelivr.net/npm/ribbon.js@latest/dist/ribbon.min.js" size="120" alpha="0.6" zindex="-1"></script><script src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lazyload@2.0.0-rc.2/lazyload.min.js"></script><script>window.addEventListener("DOMContentLoaded",function(){$(".header-nav-search").on("click",function(t){t.stopPropagation(),$("body").css("overflow","hidden"),$(".search-popup").addClass("show").velocity("stop").velocity("transition.expandIn",{duration:300,complete:function(){$(".search-popup input").focus()}}),$(".search-mask").velocity("stop").velocity("transition.fadeIn",{duration:300}),$.ajax({url:e,dataType:r?"xml":"json",async:!0,success:function(t){var n=r?$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get():t,o=$(".search-input input"),i=$(".search-results"),m={title:100,content:1},e=function(){var t=o.val().toLowerCase().trim(),x=t.split(/[\s]+/),$=[];1<x.length&&x.push(t),0<t.length&&n.forEach(function(t){var e=!1,n=t.title&&t.title.trim()||"( 文章无标题 )",o=n&&n.toLowerCase(),i=t.content&&t.content.replace(/<[^>]+>|\s+/,""),r=i&&i.toLowerCase(),c=t.url&&decodeURI(t.url).replace(/\/{2,}/,"/"),a=[],s=[];x.forEach(function(t){function e(e,t,n,o){if(!e||!t)return[];var i=0,r=-1,c=[];for(n||(e=e.toLowerCase(),t=t.toLowerCase());-1!==(r=t.indexOf(e,i));){var s=!1;a.forEach(function(t){t.index===r&&t.word.length<e.length&&(t.word=e,s=!0)}),i=r+e.length,!s&&c.push({index:r,word:e,weight:o})}return c}a=a.concat(e(t,o,!1,m.title)),s=s.concat(e(t,r,!1,m.content))});var l=a.length,u=s.length;if((0<l||0<u)&&(e=!0),e){function h(n,t,e,o){if(n&&t&&t.length){var i="",r=e,c=o;return t.forEach(function(t){if(!(t.index<r)){var e=t.index+t.word.length;i+=n.slice(r,t.index),i+="<b>"+n.slice(t.index,e)+"</b>",r=e}}),i+=n.slice(r,c)}}[a,s].forEach(function(t){t.sort(function(t,e){return t.index-e.index})});var d,f={},p=a.length*m.title+s.length*m.content,v=h(n,a,0,n.length)||n;if(0<s.length){var g=s[0].index,w=20<g?g-20:0,y=g+180;d=h(i,s,w,y)}else d=i.slice(0,200);f.title=v,f.content=d,f.url=c,f.weight=p,$.push(f)}});var e="";$.length?($.sort(function(t,e){return e.weight-t.weight}),e+="<ul>",$.forEach(function(t){e+='<li><a class="search-results-title" href="'+t.url+'">',e+=t.title,e+='</a><div class="search-results-content">',e+=t.content,e+="</div></li>"}),e+="</ul>"):e+='<div class="search-results-none"><i class="fa fa-meh-o"></i></div>',i.html(e)};o.on("input",e),o.on("keypress",function(t){t.keyCode===Stun.utils.codeToKeyCode("Enter")&&e()})}})}),$(".search-mask, .search-close").on("click",function(){n()}),$(document).on("keydown",function(t){t.keyCode===Stun.utils.codeToKeyCode("Escape")&&n()});var r=!0,t="search.json";t?/json$/i.test(t)&&(r=!1):t="search.xml";var e="/"+t;function n(){$("body").css("overflow","auto"),$(".search-popup").removeClass("show").velocity("stop").velocity("transition.expandOut",{duration:300}),$(".search-mask").velocity("stop").velocity("transition.fadeOut",{duration:300})}},!1)</script><script src="https://cdn.jsdelivr.net/npm/pjax@latest/pjax.min.js"></script><script>window.addEventListener("DOMContentLoaded",function(){new Pjax({selectors:["head title","#main",".pjax-reload",".header-info"],history:!0,scrollTo:!1,scrollRestoration:!1,cacheBust:!1,debug:!1,currentUrlFullReload:!1,timeout:0});var e=null;document.addEventListener("pjax:send",function(){$(".header-nav-menu").removeClass("show"),CONFIG.pjax.scrollTo2screen&&$("html").velocity("scroll",{duration:500,offset:$("#header").height(),easing:"easeInOutCubic"});var a=0;$(".loading-bar .progress").css("transform","translateX(-100%)"),$(".loading-bar").addClass("loading"),clearInterval(e),e=setInterval(function(){95<(a+=2)&&(a=95),$(".loading-bar .progress").css("transform","translateX("+(a-100)+"%)")},100)},!1),window.addEventListener("pjax:complete",function(){clearInterval(e),$(".loading-bar .progress").css("transform","translateX(0%)"),setTimeout(function(){$(".loading-bar").removeClass("loading"),$(".loading-bar .progress").css("transform","translateX(-100%)")},400),$("link[rel=prefetch], script[data-pjax-rm]").each(function(){$(this).remove()}),$("script[data-pjax], #pjax-reload script").each(function(){$(this).parent().append($(this).remove())}),Stun.utils.pjaxReloadBoot(),Stun.utils.pjaxReloadScroll(),Stun.utils.pjaxReloadSidebar()},!1)},!1)</script><div id="pjax-reload"><link href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" rel="stylesheet" type="text/css"><link href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/copy-tex.css" rel="stylesheet" type="text/css"><script src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/copy-tex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/quicklink@1.0.1/dist/quicklink.umd.js"></script><script>function initQuicklink() {
  quicklink({
    timeout: '10000',
    priority: 'true',
    ignores: [uri => uri.includes('#'), uri => uri === 'https://liuyib.github.io/2019/08/20/develop-hexo-theme-from-0-to-1/', /\/api\/?/,uri => uri.includes('.xml'),uri => uri.includes('.zip'),(uri, el) => el.hasAttribute('nofollow'),(uri, el) => el.hasAttribute('noprefetch')]
  });
}

if (true || false) {
  initQuicklink();
} else {
  window.addEventListener('DOMContentLoaded', initQuicklink, false);
}</script><script src="https://cdn.jsdelivr.net/gh/sukkaw/busuanzi@latest/bsz.pure.mini.js" async></script></div><script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js" data-pjax></script><script src="https://cdn.jsdelivr.net/npm/js-md5@latest/src/md5.min.js" data-pjax></script><script data-pjax>function loadGitalk(){document.getElementById("gitalk-container")&&new Gitalk({id:md5(window.location.pathname.slice(1)),clientID:"f9773b8f4bf0eab8bdf7",clientSecret:"b8cf368c44428ae4d7c9d0ec634532219e8cdf67",repo:"liuyib.github.io",owner:"liuyib",admin:["liuyib"],distractionFreeMode:"true",language:"zh-CN"}).render("gitalk-container")}loadGitalk()</script><script>"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js?t=1569061700004").then(function(){console.log("ServiceWorker Register Successfully.")}).catch(function(e){console.error(e)})</script><script type="text/javascript" src="/js/bundle.min.js"></script></body></html>